<svg viewBox="-200 -200 800 800" xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="xMidYMid meet">
  <defs>
    <!-- Singola faccia cubo (riutilizzata 6x) -->
    <rect id="face" width="80" height="80" fill="#f5f5f5">
      <animate attributeName="opacity" values="1;.97;1.03;1" dur="2s" repeatCount="indefinite" keyTimes="0;.5;1"/>
    </rect>
    <!-- Cubo completo: 6 facce con rotazioni 3D simulate via <g> + translateZ -->
    <g id="cube">
      <g transform="rotateY(0) translateZ(40)"><use href="#face"/></g>
      <g transform="rotateY(90deg) translateZ(40)"><use href="#face"/></g>
      <g transform="rotateY(180deg) translateZ(40)"><use href="#face"/></g>
      <g transform="rotateY(270deg) translateZ(40)"><use href="#face"/></g>
      <g transform="rotateX(90deg) translateZ(40)"><use href="#face"/></g>
      <g transform="rotateX(-90deg) translateZ(40)"><use href="#face"/></g>
    </g>
  </defs>

  <!-- Sfondo -->
  <rect width="100%" height="100%" fill="#e9e9e9"/>

  <!-- Contesto 3D (simulato via scale e viewBox per profonditÃ ) -->
  <g id="scene" transform="scale(.8) translate(0,0, -160)" transform-origin="center">
    <g id="assembly" transform="rotateX(-45deg) rotateY(-45deg)">
      <!-- 19 cubi interni (griglia 3x3x3 -8 angoli) -->
      <g id="inner">
        <use href="#cube" transform="translate(-80,-80,0)"/>
        <use href="#cube" transform="translate(-80,0,-80)"/>
        <use href="#cube" transform="translate(-80,0,0)"/>
        <use href="#cube" transform="translate(-80,0,80)"/>
        <use href="#cube" transform="translate(-80,80,0)"/>
        <use href="#cube" transform="translate(0,-80,-80)"/>
        <use href="#cube" transform="translate(0,-80,0)"/>
        <use href="#cube" transform="translate(0,-80,80)"/>
        <use href="#cube" transform="translate(0,0,-80)"/>
        <use href="#cube" transform="translate(0,0,0)"/>
        <use href="#cube" transform="translate(0,0,80)"/>
        <use href="#cube" transform="translate(0,80,-80)"/>
        <use href="#cube" transform="translate(0,80,0)"/>
        <use href="#cube" transform="translate(0,80,80)"/>
        <use href="#cube" transform="translate(80,-80,0)"/>
        <use href="#cube" transform="translate(80,0,-80)"/>
        <use href="#cube" transform="translate(80,0,0)"/>
        <use href="#cube" transform="translate(80,0,80)"/>
        <use href="#cube" transform="translate(80,80,0)"/>
      </g>
      <!-- 8 cubi esterni (angoli, con scale per flip) -->
      <g id="outer">
        <use href="#cube" transform="translate(160,160,160)"/>
        <use href="#cube" transform="translate(160,160,-160) scale(1,1,-1)"/>
        <use href="#cube" transform="translate(160,-160,160) scale(1,-1,1)"/>
        <use href="#cube" transform="translate(160,-160,-160) scale(1,-1,-1)"/>
        <use href="#cube" transform="translate(-160,160,160) scale(-1,1,1)"/>
        <use href="#cube" transform="translate(-160,160,-160) scale(-1,1,-1)"/>
        <use href="#cube" transform="translate(-160,-160,160) scale(-1,-1,1)"/>
        <use href="#cube" transform="translate(-160,-160,-160) scale(-1,-1,-1)"/>
      </g>
    </g>
  </g>

  <!-- Animazioni SMIL (riplicano keyframes originali: rotazioni + translate per assemblaggio) -->
  <!-- Rotazione interna (ri: Y da -180 a 0, poi X a -180) -->
  <animateTransform href="#inner" attributeName="transform" type="rotateY" values="-180 0 0;0 0 0;-180 0 0" dur="2s" repeatCount="indefinite" keyTimes="0;0.5;1" keySplines="0.42 0 0.58 1;0.42 0 0.58 1"/>
  <animateTransform href="#inner" attributeName="transform" type="rotateX" values="0 0 0;0 0 0;-180 0 0" dur="2s" repeatCount="indefinite" keyTimes="0;0.5;1" keySplines=".42 0 .58 1;.42 0 .58 1" additive="sum"/>

  <!-- Rotazione esterna (ro: rotate -180 a 0) + movimento assemblaggio (m: translate da 0 a (160,160,160)) -->
  <animateTransform href="#outer" attributeName="transform" type="rotate" values="-180 0 0;0 0 0" dur="2s" repeatCount="indefinite" keyTimes="0;1" keySplines="0.42 0 0.58 1"/>
  <animateTransform href="#outer" attributeName="transform" type="translate" values="0 0 0;0 0 0;160 160 160;160 160 160;0 0 0" dur="2s" repeatCount="indefinite" keyTimes="0;0.15;0.35;0.65;1" keySplines="0.42 0 0.58 1;0.42 0 0.58 1;0.42 0 0.58 1;0.42 0 0.58 1" additive="sum"/>
</svg>
