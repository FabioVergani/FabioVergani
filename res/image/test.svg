<svg width="220" height="220" viewBox="0 0 220 220" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
  <!-- FORZA contesto 3D sul foreignObject (questo Ã¨ il fix critico) -->
  <foreignObject width="220" height="220" transform="translateZ(0)" requiredExtensions="http://www.w3.org/1999/xhtml">
    <body xmlns="http://www.w3.org/1999/xhtml" style="
      margin:0;
      overflow:hidden;
      height:220px;
      width:220px;
      perspective:32em;
      background:#e9e9e9;
    ">
      <style>
        div{position:absolute;transform-style:preserve-3d}
        .assembly{top:50%;left:50%;transform:rotateX(-45deg) rotateY(-45deg)}
        .comp-3d{animation:r 2s ease-in-out infinite}
        .comp-3d--i{animation-name:ri}
        .comp-3d--o{animation-name:ro}
        @keyframes ri{0%,20%{transform:rotateY(-.5turn)}50%{transform:none}80%,100%{transform:rotateX(-.5turn)}}
        @keyframes ro{0%,35%{transform:rotate(-.5turn)}65%,100%{transform:none}}
        @keyframes m{
          0%,5%,95%,100%{transform:none}
          15%{transform:translate3d(0,4em,0)}
          25%{transform:translate3d(0,4em,4em)}
          35%,65%{transform:translate3d(4em,4em,4em)}
          75%{transform:translate3d(4em,0,4em)}
          85%{transform:translate3d(4em,0,0)}
        }
        .pos:nth-child(1){transform:scale3d(1,1,1)translate3d(4em,4em,4em)}
        .pos:nth-child(2){transform:scale3d(1,1,-1)translate3d(4em,4em,4em)}
        .pos:nth-child(3){transform:scale3d(1,-1,1)translate3d(4em,4em,4em)}
        .pos:nth-child(4){transform:scale3d(1,-1,-1)translate3d(4em,4em,4em)}
        .pos:nth-child(5){transform:scale3d(-1,1,1)translate3d(4em,4em,4em)}
        .pos:nth-child(6){transform:scale3d(-1,1,-1)translate3d(4em,4em,4em)}
        .pos:nth-child(7){transform:scale3d(-1,-1,1)translate3d(4em,4em,4em)}
        .pos:nth-child(8){transform:scale3d(-1,-1,-1)translate3d(4em,4em,4em)}
        :not(.pos)>.cube:nth-child(1){transform:translate3d(-4em,-4em,0)}
        :not(.pos)>.cube:nth-child(2){transform:translate3d(-4em,0,-4em)}
        :not(.pos)>.cube:nth-child(3){transform:translate3d(-4em,0,0)}
        :not(.pos)>.cube:nth-child(4){transform:translate3d(-4em,0,4em)}
        :not(.pos)>.cube:nth-child(5){transform:translate3d(-4em,4em,0)}
        :not(.pos)>.cube:nth-child(6){transform:translate3d(0,-4em,-4em)}
        :not(.pos)>.cube:nth-child(7){transform:translate3d(0,-4em,0)}
        :not(.pos)>.cube:nth-child(8){transform:translate3d(0,-4em,4em)}
        :not(.pos)>.cube:nth-child(9){transform:translate3d(0,0,-4em)}
        :not(.pos)>.cube:nth-child(10){transform:translate3d(0,0,0)}
        :not(.pos)>.cube:nth-child(11){transform:translate3d(0,0,4em)}
        :not(.pos)>.cube:nth-child(12){transform:translate3d(0,4em,-4em)}
        :not(.pos)>.cube:nth-child(13){transform:translate3d(0,4em,0)}
        :not(.pos)>.cube:nth-child(14){transform:translate3d(0,4em,4em)}
        :not(.pos)>.cube:nth-child(15){transform:translate3d(4em,-4em,0)}
        :not(.pos)>.cube:nth-child(16){transform:translate3d(4em,0,-4em)}
        :not(.pos)>.cube:nth-child(17){transform:translate3d(4em,0,0)}
        :not(.pos)>.cube:nth-child(18){transform:translate3d(4em,0,4em)}
        :not(.pos)>.cube:nth-child(19){transform:translate3d(4em,4em,0)}
        .pos .cube{animation:m 2s ease-out infinite}
        .cube__face{
          margin:-2em;width:4em;height:4em;
          backface-visibility:hidden;
          background:whitesmoke;
          box-shadow:0 0 2em rgba(220,220,220,.5) inset;
        }
        .cube__face:nth-child(2n){filter:brightness(.97)}
        .cube__face:nth-child(n+5){filter:brightness(1.03)}
        .cube__face:nth-child(1){transform:rotateY(0)translateZ(2em)}
        .cube__face:nth-child(2){transform:rotateY(90deg)translateZ(2em)}
        .cube__face:nth-child(3){transform:rotateY(180deg)translateZ(2em)}
        .cube__face:nth-child(4){transform:rotateY(270deg)translateZ(2em)}
        .cube__face:nth-child(5){transform:rotateX(90deg)translateZ(2em)}
        .cube__face:nth-child(6){transform:rotateX(-90deg)translateZ(2em)}
      </style>

      <div class="assembly">
        <!-- 19 cubi interni (markup 100% originale) -->
        <div class="comp-3d comp-3d--i">
          <div class="cube"><div class="cube__face"></div><div class="cube__face"></div><div class="cube__face"></div><div class="cube__face"></div><div class="cube__face"></div><div class="cube__face"></div></div>
          <div class="cube"><div class="cube__face"></div><div class="cube__face"></div><div class="cube__face"></div><div class="cube__face"></div><div class="cube__face"></div><div class="cube__face"></div></div>
          <div class="cube"><div class="cube__face"></div><div class="cube__face"></div><div class="cube__face"></div><div class="cube__face"></div><div class="cube__face"></div><div class="cube__face"></div></div>
          <div class="cube"><div class="cube__face"></div><div class="cube__face"></div><div class="cube__face"></div><div class="cube__face"></div><div class="cube__face"></div><div class="cube__face"></div></div>
          <div class="cube"><div class="cube__face"></div><div class="cube__face"></div><div class="cube__face"></div><div class="cube__face"></div><div class="cube__face"></div><div class="cube__face"></div></div>
          <div class="cube"><div class="cube__face"></div><div class="cube__face"></div><div class="cube__face"></div><div class="cube__face"></div><div class="cube__face"></div><div class="cube__face"></div></div>
          <div class="cube"><div class="cube__face"></div><div class="cube__face"></div><div class="cube__face"></div><div class="cube__face"></div><div class="cube__face"></div><div class="cube__face"></div></div>
          <div class="cube"><div class="cube__face"></div><div class="cube__face"></div><div class="cube__face"></div><div class="cube__face"></div><div class="cube__face"></div><div class="cube__face"></div></div>
          <div class="cube"><div class="cube__face"></div><div class="cube__face"></div><div class="cube__face"></div><div class="cube__face"></div><div class="cube__face"></div><div class="cube__face"></div></div>
          <div class="cube"><div class="cube__face"></div><div class="cube__face"></div><div class="cube__face"></div><div class="cube__face"></div><div class="cube__face"></div><div class="cube__face"></div></div>
          <div class="cube"><div class="cube__face"></div><div class="cube__face"></div><div class="cube__face"></div><div class="cube__face"></div><div class="cube__face"></div><div class="cube__face"></div></div>
          <div class="cube"><div class="cube__face"></div><div class="cube__face"></div><div class="cube__face"></div><div class="cube__face"></div><div class="cube__face"></div><div class="cube__face"></div></div>
          <div class="cube"><div class="cube__face"></div><div class="cube__face"></div><div class="cube__face"></div><div class="cube__face"></div><div class="cube__face"></div><div class="cube__face"></div></div>
          <div class="cube"><div class="cube__face"></div><div class="cube__face"></div><div class="cube__face"></div><div class="cube__face"></div><div class="cube__face"></div><div class="cube__face"></div></div>
          <div class="cube"><div class="cube__face"></div><div class="cube__face"></div><div class="cube__face"></div><div class="cube__face"></div><div class="cube__face"></div><div class="cube__face"></div></div>
          <div class="cube"><div class="cube__face"></div><div class="cube__face"></div><div class="cube__face"></div><div class="cube__face"></div><div class="cube__face"></div><div class="cube__face"></div></div>
          <div class="cube"><div class="cube__face"></div><div class="cube__face"></div><div class="cube__face"></div><div class="cube__face"></div><div class="cube__face"></div><div class="cube__face"></div></div>
          <div class="cube"><div class="cube__face"></div><div class="cube__face"></div><div class="cube__face"></div><div class="cube__face"></div><div class="cube__face"></div><div class="cube__face"></div></div>
          <div class="cube"><div class="cube__face"></div><div class="cube__face"></div><div class="cube__face"></div><div class="cube__face"></div><div class="cube__face"></div><div class="cube__face"></div></div>
        </div>

        <!-- 8 cubi esterni (markup 100% originale) -->
        <div class="comp-3d comp-3d--o">
          <div class="pos"><div class="cube"><div class="cube__face"></div><div class="cube__face"></div><div class="cube__face"></div><div class="cube__face"></div><div class="cube__face"></div><div class="cube__face"></div></div></div>
          <div class="pos"><div class="cube"><div class="cube__face"></div><div class="cube__face"></div><div class="cube__face"></div><div class="cube__face"></div><div class="cube__face"></div><div class="cube__face"></div></div></div>
          <div class="pos"><div class="cube"><div class="cube__face"></div><div class="cube__face"></div><div class="cube__face"></div><div class="cube__face"></div><div class="cube__face"></div><div class="cube__face"></div></div></div>
          <div class="pos"><div class="cube"><div class="cube__face"></div><div class="cube__face"></div><div class="cube__face"></div><div class="cube__face"></div><div class="cube__face"></div><div class="cube__face"></div></div></div>
          <div class="pos"><div class="cube"><div class="cube__face"></div><div class="cube__face"></div><div class="cube__face"></div><div class="cube__face"></div><div class="cube__face"></div><div class="cube__face"></div></div></div>
          <div class="pos"><div class="cube"><div class="cube__face"></div><div class="cube__face"></div><div class="cube__face"></div><div class="cube__face"></div><div class="cube__face"></div><div class="cube__face"></div></div></div>
          <div class="pos"><div class="cube"><div class="cube__face"></div><div class="cube__face"></div><div class="cube__face"></div><div class="cube__face"></div><div class="cube__face"></div><div class="cube__face"></div></div></div>
          <div class="pos"><div class="cube"><div class="cube__face"></div><div class="cube__face"></div><div class="cube__face"></div><div class="cube__face"></div><div class="cube__face"></div><div class="cube__face"></div></div></div>
        </div>
      </div>
    </body>
  </foreignObject>
</svg>
